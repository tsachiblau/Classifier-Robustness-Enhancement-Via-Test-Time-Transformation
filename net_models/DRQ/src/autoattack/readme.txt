Code adjusted from https://github.com/fra31/auto-attack